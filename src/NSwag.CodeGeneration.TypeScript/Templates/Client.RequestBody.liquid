{%- if operation.HasFormParameters -%}
{%-         for parameter in operation.FormParameters -%}
{%-             if parameter.IsRequired -%}
{%-                 if parameter.IsNullable -%}
Guard.defined({{ parameter.VariableName }}, "{{ parameter.VariableName }}");
{%-                 else -%}
Guard.required({{ parameter.VariableName }}, "{{ parameter.VariableName }}");
{%-                 endif -%}
{%-             else -%}
{%-                 if parameter.IsNullable -%}
Guard.defined({{ parameter.VariableName }}, "{{ parameter.VariableName }}");
{%-                 else -%}
Guard.notNull({{ parameter.VariableName }}, "{{ parameter.VariableName }}");
{%-                 endif -%}
{%-             endif -%}
{%-         endfor -%}

{%-     if operation.ConsumesOnlyFormUrlEncoded -%}
const content_ = new UriBuilder("")
{%-         for parameter in operation.FormParameters -%}
{%-             if parameter.IsDateOrDateTimeArray -%}
    .paramArray("{{ parameter.Name }}", {{ parameter.VariableName }}.map(d => d ? d.toJSON() : ""))
{%-             elsif parameter.IsObjectArray -%}
    .paramObjectArray("{{ parameter.Name }}", {{ parameter.VariableName }})
{%-             elsif parameter.IsDateOrDateTime -%}
    .param("{{ parameter.Name }}", {{ parameter.VariableName }} ? {{ parameter.VariableName }}.toJSON() : "")
{%-             elsif parameter.IsArray -%}
    .paramArray("{{ parameter.Name }}", {{ parameter.VariableName }})
{%-             else -%}
    .param("{{ parameter.Name }}", {{ parameter.VariableName }})
{%-             endif -%}
{%-         endfor -%}
    .toString();

{%-     else -%}
const content_ = new FormData();
{%         for parameter in operation.FormParameters -%}
{%-             if parameter.IsFile -%}
{%-                 if parameter.IsArray -%}
{{ parameter.VariableName }}.forEach(item_ => content_.append("{{ parameter.Name }}", item_.data, item_.fileName ? item_.fileName : "{{ parameter.Name }}") );
{%-                 else -%}
content_.append("{{ parameter.Name }}", {{ parameter.VariableName }}.data, {{ parameter.VariableName }}.fileName ? {{ parameter.VariableName }}.fileName : "{{ parameter.Name }}");
{%-                 endif -%}
{%-             elsif parameter.IsDateOrDateTime -%}
content_.append("{{ parameter.Name }}", {{ parameter.VariableName }}.toJSON());
{%-             elsif parameter.IsObject -%}
content_.append("{{ parameter.Name }}", JSON.stringify({{ parameter.VariableName }}));
{%-             elsif parameter.IsArray -%}
{{ parameter.VariableName }}.forEach(item_ => content_.append("{{ parameter.Name }}", item_.toString()));
{%-             else -%}
content_.append("{{ parameter.Name }}", {{ parameter.VariableName }}.toString());
{%-             endif -%}
{%-         endfor -%}
{%-     endif -%}
{%- else -%}
{%-     if operation.HasContent -%}
{%-         if operation.HasBinaryBodyParameter -%}
const content_ = {{ operation.ContentParameter.VariableName }};
{%-         elsif operation.HasXmlBodyParameter -%}
const content_ = {{ operation.ContentParameter.VariableName }};
{%          elsif operation.Consumes == "application/x-www-form-urlencoded" -%}
const content_ = Object.keys({{ operation.ContentParameter.VariableName }} as any).map((key) => {
    return encodeURIComponent(key) + '=' + encodeURIComponent(({{ operation.ContentParameter.VariableName }} as any)[key]);
}).join('&')
{%-         elsif operation.HasPlainTextBodyParameter -%}
const content_ = {{ operation.ContentParameter.VariableName }};
{%-         else -%}
const content_ = JSON.stringify({{ operation.ContentParameter.VariableName }});
{%-         endif -%}
{%-     else -%}
const content_ = undefined;
{%-     endif -%}
{%- endif -%}
